
* Dependencies
** erlang modules
   erlsha2 common auth
** external programs
   imagemagick

* To Dos
** DONE should remember name and tripcode when starting a thread
   CLOSED: [2012-07-23 Mon 22:03]
   - CLOSING NOTE [2012-07-23 Mon 22:04] \\
     -System now records your username and tripcode when you start a new thread. 
     It may actually be better to do it on each comment post
   - probably SHOULDN'T keep this in session state 'cause it might cause
     counterintuitive behavior when someone's speaking on multiple threads
   - actually, now that I think about it, session state isn't a bad idea for this.
     the only way it could bite you is if you're simultaneously starting multiple threads
     and want to have a different name/trip in each one
** DONE should highlight/animate new messages
   CLOSED: [2012-07-23 Mon 22:17]
   - CLOSING NOTE [2012-07-23 Mon 22:18] \\
     -New comments are now highlighted as they're posted
   This is going to require dicking around with Nitrogen paths
** DONE lay out messages a bit more compactly (maybe reduce preview size to 200 or so)
   CLOSED: [2012-07-23 Mon 21:24]
   - CLOSING NOTE [2012-07-23 Mon 21:25] \\
     -Image preview size is now 250, max image size is 2MB (may reduce that based on traffic)
     -Line height and padding have been blown away on individual comments
** DONE do something intelligent with input newlines, rather than just dropping them
   CLOSED: [2012-07-23 Mon 17:54]
** DONE JS-based tripcode comparison
   CLOSED: [2012-07-23 Mon 21:48]
   - CLOSING NOTE [2012-07-23 Mon 21:49] \\
     Mousing over a tripcode now highlights all instances of the same tripcode
** DONE dynamic front page (update latest messages to threads and reorder them properly)
   CLOSED: [2012-07-23 Mon 23:21]
   - CLOSING NOTE [2012-07-23 Mon 23:21] \\
     Done. That's going to be spawning processes and calls straight out the ass, but done and working nicely.
  
** DONE Limit comment size in some way
   CLOSED: [2012-08-09 Thu 11:15]
   - CLOSING NOTE [2012-08-09 Thu 11:17] \\
     - Comments now cache their previews 
     - previews are generated by 
        - taking the first 250 characters of the first non-empty line in a comment
        - noting how many characters/lines were omitted (no note if none were dropped)
   - Preview should have a cap of ~200 characters. In fact, it should probably
     do something like take the first non-empty parsed line of the message and preview the
     first 200 characters of that.
   - Full comment should have a much higher, but finite limit (more like ~15K than ~200)
** DONE Limit field size to some semi-reasonable character count
   CLOSED: [2012-07-24 Tue 00:18]
   - CLOSING NOTE [2012-07-24 Tue 00:18] \\
     Done
   - Really don't know why I'd go lower than 100 characters or so for either tripcode or username
   - Consider doing ~100 for username and ~250 for tripcode
** DONE Have a default username set by board, and use that if the user doesn't enter one
   CLOSED: [2012-07-27 Fri 17:10]
   - CLOSING NOTE [2012-07-27 Fri 17:11] \\
     Check. The default default_name is "Anonymous".
** TODO Hook up auth and set up a moderation system
   Mods should be able to 
*** DONE delete pictures
    CLOSED: [2012-08-01 Wed 18:05]
    - CLOSING NOTE [2012-08-01 Wed 18:05] \\
      Picture deleting now works
*** DONE delete comments
    CLOSED: [2012-08-01 Wed 18:05]
    - CLOSING NOTE [2012-08-01 Wed 18:06] \\
      Comment deleting now works
*** DONE delete threads
    CLOSED: [2012-08-03 Fri 18:39]
    - CLOSING NOTE [2012-08-03 Fri 18:39] \\
      Thread deletion now works
*** DONE move threads to different boards
    CLOSED: [2012-08-06 Mon 21:05]
    - CLOSING NOTE [2012-08-06 Mon 21:05] \\
      Threads can now be properly moved between boards
    Keep in mind that you'll need to
    1. Move the thread
    2. Redirect everyone that was on the old thread
    3. Set up a temporary re-director for people that might still have stale links on screen
    Another way to solve this would be to remove the board/thread hierarchy.
    That way moving a thread over has no actual effect on any links, but the breadcrumb trail
    becomes a personal thing; we should notify people in threads that they've been transplanted.
*** DONE start new boards
    CLOSED: [2012-08-07 Tue 02:54]
    - CLOSING NOTE [2012-08-07 Tue 02:55] \\
      Admins can now start new boards, though the interface and name of the relevant module is less than stellar
*** TODO protect threads in some pre-emptive way. Not sure how yet, so no-op this one for now
       - force captcha?
       - force login?
       - force posting delay?
*** TODO set up user levels
    There should be 3;
       1. global mods -- server owner and people they choose. These guys have mod rights everywhere.
       2. users -- people with registered accounts. They may be mods on certain boards 
	  (boards should have a list of admins; handle this through the group system?
	   Seems like what it was built for, and it has the associated primitives there already.
	   Adding a new board adds a new group too.)
	  Log their actions mercilessly.
       3. anons -- people without registered accounts. No tracking at all of these guys, though they
	  can't start communities or moderate without an account.
*** TODO set up user management frontend
    Draggable-based system to let mods organize their users in cool ways
** TODO set up registration and login system
   Mods aren't the only ones that can register.
   You should set up a registration system that all users can optionally participate in.
   If you're a logged in member, you shouldn't get a tripcode field; instead, the system should
   generate a secure backend tripcode and make it stand out somehow.
   That should be ALL. The idea is that a fixed identity is a burden on the user, which they need to
   carry in order to 
      1. start a board
      2. moderate one or more boards
   
*** DONE login page
    CLOSED: [2012-08-01 Wed 08:25]
    - CLOSING NOTE [2012-08-01 Wed 08:25] \\
      Login page has been created.
*** DONE register page
    CLOSED: [2012-08-01 Wed 08:27]
    - CLOSING NOTE [2012-08-01 Wed 08:27] \\
      Minimal register page done.
      We don't even have a captcha.
    Make it minimal; remember, registering is a bad thing. 
    You only really need to endure it if you want to start your own board, or if you want to be added as a mod somewhere.
    
*** DONE login/logout link somewhere on existing page
    CLOSED: [2012-08-01 Wed 12:00]
    - CLOSING NOTE [2012-08-01 Wed 12:00] \\
      Added appropriate, contextually displayed links to the comment_form
    I'm thinking set up the posting form as a toolbar, and add this to that
*** TODO set up RSA-key login system, see how it works and what components it needs
** DONE Change the echo functions to elements
   CLOSED: [2012-07-30 Mon 10:53]
   - CLOSING NOTE [2012-07-30 Mon 10:54] \\
     -Done. Instead of having echo functions, we now have element records and associated rendering functions.
     -The more comlex elements have a from_tup/1 function which takes model output and renders the appropriate element
** TODO Change some of the event functions into actions
** TODO Create custom form element/behavior to avoid the event finangling with the default nitrogen upload
** DONE Add description and deleted image for boards
   CLOSED: [2012-08-03 Fri 18:41]
   - CLOSING NOTE [2012-08-03 Fri 18:42] \\
     Not doing deleted-image field.
     A deleted image is represented as a span with the text "DELETED FILE" in it. 
     The actual contents/background image of said span will be determined via CSS (which we should be able to vary by board)
   Added and hooked up description field.
   Added deleted image field, but haven't hooked it up properly yet
** DONE Add a way to delete images/comments/threads/boards
   CLOSED: [2012-07-30 Mon 16:51]
   - CLOSING NOTE [2012-07-30 Mon 16:53] \\
     - Threads, comments and images are now deletable (though not undeletable, and never will be)
     - Boards can't be deleted, the point of the deletion elements is going to be limiting spam and idiocy, and I can't see an entire board getting to the point that it needs to go
** DONE Check whether the thread is active before displaying certain things
   CLOSED: [2012-07-30 Mon 23:22]
   - CLOSING NOTE [2012-07-30 Mon 23:22] \\
     Reply link now only shown for active threads (will need to figure out what's happening when it comes to archived threads later)
   The reply button shouldn't be shown for a dead thread
** DONE Separate summarize/1 into two functions
   CLOSED: [2012-07-30 Mon 23:05]
   - CLOSING NOTE [2012-07-30 Mon 23:05] \\
     Done. Note that summarize/1 is now only used by the external API
   One that deals with converting records to tuples (to_tup/1)
   One that deals with outputting summary data (summarize/1)
** DONE Re-write the database interactions in boards.erl to use the db: package more effectively (common is already a dependency)
   CLOSED: [2012-07-30 Mon 16:50]
   - CLOSING NOTE [2012-07-30 Mon 16:50] \\
     Done.
     
** DONE when a new message is added to a thread page, scroll down if the user is already at or near the bottom
   CLOSED: [2012-08-04 Sat 01:35]
   - CLOSING NOTE [2012-08-04 Sat 01:36] \\
     If a user is within 1000px (may need to adjust the number) of the bottom, the view scrolls down to show the latest comment
** TODO Add board-specific CSS option
** DONE Make deletion work in realtime using the comet-pooling feature
   CLOSED: [2012-08-04 Sat 01:18]
   - CLOSING NOTE [2012-08-04 Sat 01:18] \\
     Deletions and restores now send messages to appropriate comet pools
** TODO Comment markup components
*** TODO Link to comment
*** TODO Quote things
    Actually, pretty much the whole markdown system could stand to be incorporated.
** TODO Spoiler/NSFW image tags
** TODO Stickied threads
*** TODO Make threads stickiable
*** TODO Allow moderators to sticky threads
** TODO comment responses
   When a new comment is posted, analyze all the comments it responds to and cache the link in those comments
   Max ten comments being referred to, only add a unique link (if someone puts in 30 links to the same comment,
   the effect should be a single link to that comment).
** TODO convert the nitrogen/erlang communication layer to proplists rather than using records or tuples
